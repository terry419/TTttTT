1. 핵심 시스템 클래스 명세
1.1. MonsterController.cs (엔진 / MonoBehaviour)
역할: 몬스터 Prefab에 부착되는 유일한 AI 스크립트. AI 상태 기계를 구동하고, 각종 컴포넌트 참조를 '행동 부품'에 제공하는 중앙 허브 역할을 합니다.

상속 관계: UnityEngine.MonoBehaviour를 상속합니다.

주요 변수 및 기능:

공개 변수 (Public Properties for Behaviors): 모든 행동 및 결정 부품들이 접근하여 읽어야 하는 정보입니다.

playerTransform (Transform): 플레이어의 위치 정보.

monsterData (MonsterDataSO): 현재 몬스터의 원본 데이터.

monsterStats (MonsterStats): 현재 몬스터의 실시간 능력치 컴포넌트.

rb (Rigidbody2D): 물리 이동을 위한 Rigidbody2D 컴포넌트.

startPosition (Vector3): 몬스터가 처음 스폰된 위치.

stateTimer (float): 현재 행동으로 전환된 후 얼마나 시간이 지났는지 알려주는 타이머.

공개 기능 (Public Methods for Behaviors): 행동 부품들이 MonsterController에 요청할 수 있는 기능입니다.

ChangeBehavior(MonsterBehavior newBehavior): 현재 행동을 새로운 행동으로 즉시 교체합니다.

ApplySelfStatusEffect(StatusEffectDataSO effect): 몬스터 자신에게 상태 이상을 적용합니다 ('탈진' 효과 구현에 사용).

내부 변수 (Private Fields):

currentBehavior (MonsterBehavior): 현재 실행 중인 행동 부품의 참조.

1.2. MonsterDataSO.cs (조립 설명서 / ScriptableObject)
역할: 몬스터 한 종류의 모든 데이터를 정의하는 ScriptableObject. Inspector에서 이 에셋을 통해 몬스터의 AI를 조립합니다.

상속 관계: UnityEngine.ScriptableObject를 상속합니다.

주요 변수 및 기능:

기본 정보: monsterName (string), prefabRef (AssetReferenceGameObject) 등.

기본 능력치: maxHealth (float), moveSpeed (float) 등.

AI 조립 정보:

initialBehavior (MonsterBehavior): 이 몬스터가 처음 시작할 행동 부품 에셋.

onDeathZoneEffect (CreateZoneEffectSO): 사망 시 생성할 장판 효과 에셋.

1.3. MonsterBehavior.cs (추상 행동 부품 / ScriptableObject)
역할: '추격', '돌진' 등 모든 행동 부품의 설계도 역할을 하는 추상 클래스.

상속 관계: UnityEngine.ScriptableObject를 상속합니다. 모든 구체적인 행동 부품은 이 클래스를 상속받아야 합니다.

주요 변수 및 기능:

공개 변수 (Inspector 설정용):

transitions (List<Transition>): 이 행동이 다른 행동으로 전환될 수 있는 '전환 규칙'의 목록.

상속 기능 (자식 클래스가 구현해야 할 기능):

OnEnter(MonsterController monster): 이 행동이 처음 시작될 때 단 한 번 호출될 초기화 로직.

OnExecute(MonsterController monster): 이 행동이 활성화된 동안 매 프레임 실행될 핵심 동작 로직.

OnExit(MonsterController monster): 이 행동이 다른 행동으로 전환되기 직전 단 한 번 호출될 마무리 로직.

1.4. Decision.cs (추상 결정 부품 / ScriptableObject)
역할: "플레이어가 범위 안에 있는가?" 와 같은 모든 판단 조건의 설계도 역할을 하는 추상 클래스.

상속 관계: UnityEngine.ScriptableObject를 상속합니다. 모든 구체적인 결정 부품은 이 클래스를 상속받아야 합니다.

주요 변수 및 기능:

상속 기능 (자식 클래스가 구현해야 할 기능):

Decide(MonsterController monster): 현재 상황을 판단하여 true 또는 false를 반환하는 기능.

1.5. Transition.cs (연결 규칙 / 일반 Class)
역할: '결정'과 '행동'을 묶어 하나의 전환 규칙을 정의하는 데이터 컨테이너.

상속 관계: 없음. [System.Serializable] 특성을 가집니다.

주요 변수 및 기능:

공개 변수 (Inspector 설정용):

decision (Decision): 어떤 '결정' 부품을 사용할지 연결하는 슬롯.

nextBehavior (MonsterBehavior): 위 decision이 '참'일 경우, 다음으로 전환할 '행동' 부품을 연결하는 슬롯.

2. 행동 부품 (Behavior) 상세 명세
ChaseBehavior

상속: MonsterBehavior

기능: 대상을 추격합니다.

Inspector 설정 변수: speedMultiplier (float) (추격 시 이동 속도 배율).

FleeBehavior

상속: MonsterBehavior

기능: 대상으로부터 도망칩니다.

Inspector 설정 변수: speedMultiplier (float) (도주 시 이동 속도 배율).

ChargeBehavior

상속: MonsterBehavior

기능: '조준 -> 방향조절 -> 돌진'의 순서로 공격합니다.

Inspector 설정 변수:

aimingDuration (float): 제자리에서 멈춰 대기하는 시간.

windupDuration (float): 플레이어 방향으로 느리게 전진하며 방향을 조절하는 시간.

windupSpeedMultiplier (float): 방향 조절 시의 속도 배율.

chargeSpeedMultiplier (float): 실제 돌진 속도 배율.

chargePlayerPredictionFactor (float): 플레이어 이동 예측 정확도 계수.

chargeDistance (float): 최대 돌진 거리.

chargeExhaustionEffect (StatusEffectDataSO): 돌진 후 자신에게 적용할 '탈진' 상태이상 에셋.

SkirmishBehavior

상속: MonsterBehavior

기능: 대상과 일정한 거리를 유지합니다.

Inspector 설정 변수:

tooCloseDistance (float): 이 거리보다 가까우면 후퇴합니다.

tooFarDistance (float): 이 거리보다 멀면 접근합니다.

SummonBehavior

상속: MonsterBehavior

기능: 하수인을 소환합니다.

Inspector 설정 변수:

minionToSummon (MonsterDataSO): 소환할 하수인의 MonsterDataSO 에셋.

summonCount (int): 한 번에 소환할 하수인 수.

summonCastTime (float): 소환 동작 시간.

3. 결정 부품 (Decision) 상세 명세
PlayerInRangeDecision

상속: Decision

기능: 플레이어가 지정된 범위 안에 있는지 판단합니다.

Inspector 설정 변수:

range (float): 판단 기준 거리.

negate (bool): true일 경우, 범위 '밖'에 있을 때 '참'을 반환하도록 결과를 반전시킵니다.

TimerDecision

상속: Decision

기능: 현재 행동을 시작한 후 지정된 시간이 지났는지 판단합니다.

Inspector 설정 변수: duration (float): 판단 기준 시간.

4. 기존 스크립트와의 상호작용
새로운 AI 부품들은 MonsterController를 통해 기존 스크립트의 아래 변수 및 기능들에 접근해야 합니다.

MonsterStats로부터 상속(접근)할 변수/기능:

FinalMoveSpeed (float): 최종 이동 속도.

CurrentHealth (float): 현재 체력.

FinalMaxHealth (float): 최종 최대 체력.

StatusEffectManager로부터 상속(접근)할 변수/기능:

ApplyStatusEffect(GameObject, StatusEffectInstance): MonsterController의 ApplySelfStatusEffect 내부에서 호출될 기능.

Rigidbody2D로부터 상속(접근)할 변수/기능:

velocity (Vector2): 몬스터의 이동 속도를 직접 제어하기 위해 접근.